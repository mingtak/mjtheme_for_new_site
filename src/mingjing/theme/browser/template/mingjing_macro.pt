<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
    lang="en"
    metal:use-macro="context/main_template/macros/master"
    i18n:domain="mingjing.content">
<body>


<!-- li listing 一般通用列表 傳入items(catalog brain) -->
  <metal:row define-macro="li-listing">
    <div class="li-listing">
      <ul>
          <li tal:repeat="item items">
              <a href="${item/getURL}">${item/Title}</a>
          </li>
      </ul>
    </div>
  </metal:row>





<!-- 通用slider, 傳入: items -->
  <metal:row define-macro="normal_slider">
      <div class="normal_slider">

<div class="owl-theme owl-carousel">
  <div class="normal_slider_item" tal:repeat="item items">

      <tal:img switch="python:bool(getattr(item.getObject(), 'image', False))">
          <img tal:case="python:True"
               src="${item/getURL}/@@images/image/large" alt="${item/Title}"/>
          <tal:noimg case="default">
              <img src="${portal/absolute_url}/resource/images/logo_gray.png/@@images/image/large" alt="${item/Title}"/>
          </tal:noimg>
      </tal:img>


   <!--   <img src="${item/getURL}/@@images/image/large" alt="${item/Title}" /> -->
      <a href="${item/getURL}" title="${item/Description}">
          <h4 class="normal-item-title">${python:item.Title[0:70]}${python:'...' if len(item.Title)>70 else None}</h4>
      </a>
  </div>
</div>

      </div>
  </metal:row>


<!-- 今日熱門 for tv, 傳入 youtube content type(brain) -->
<metal:row define-macro="youtube_today_hot">
    <div class="youtube_today_hot" tal:define="y_id python:items.getObject().youtubeURL.split('/')[-1]">
        <iframe width="100%" height="420" src="https://www.youtube.com/embed/${y_id}/" frameborder="0" allowfullscreen></iframe>
    </div>
</metal:row>


<!-- 網友熱搜 Tags, 傳入 categories url_quote -->
<metal:row define-macro="subjects">

                <p>
                    <span id="categories-filed-under">網友熱搜:</span>
                    <tal:tag repeat="category categories">
                        <a rel="tag"
                           tal:define="quotedCat python:url_quote(category)"
                           tal:attributes="href string:${context/@@plone_portal_state/navigation_root_url}/@@search?Subject%3Alist=${quotedCat}">
                           ${category}
                        </a><span tal:condition="not:repeat/category/end"> / </span>
                    </tal:tag>
                </p>

</metal:row>


<!-- 節目表 live_program -->
  <metal:row define-macro="live_program">
      <?python from datetime import datetime ?>
      <div class="live_program">
                <h4>節目表(美國東部時間)</h4>
          <table>
              <tbody>
                  <tal:item repeat="item items">
                      <tr tal:define="checkLive python:datetime.now()>item.get('start') and datetime.now()<item.get('end')"
                          class="${python:'odd' if repeat['item'].even else 'even'}
                                 ${python:'now' if checkLive else ''}">
                          <td class="time">
                              ${python:item.get('start').strftime('%H:%M')}
                              <br tal:condition="checkLive" />
                              <span tal:condition="checkLive" style="font-size:12px; color:blue">${python:'播放中' if checkLive else ''}</span>
                          </td>
                          <td class="title"><a href="${python:item['uri']}" target="_blank">${python:item.get('name')}</a></td>
                      </tr>
                  </tal:item>
              </tbody>
          </table>
      </div>
  </metal:row>

<!-- 電台 youtube radio list 傳入 radioList in Cover, side: 'odd', 'even' or 'single'. (Cover content type only) -->
  <metal:row define-macro="radio_listing">
      <div class="radio-listing">
          <ul>
              <tal:li repeat="item python:context.radioList.split('\n')[0:10]"
                      switch="side">
                  <li tal:case="string:even" tal:condition="repeat/item/even">
                      <a href="${python:item.split('|||')[1]}" target="_blank">${python:item.split('|||')[0][0:23]}<span tal:condition="python:len(item.split('|||')[0])>23">...</span></a>
                  </li>
                  <li tal:case="string:odd" tal:condition="repeat/item/odd">
                      <a href="${python:item.split('|||')[1]}" target="_blank">${python:item.split('|||')[0][0:23]}<span tal:condition="python:len(item.split('|||')[0])>23">...</span></a>
                  </li>
                  <li tal:case="string:single">
                      <a href="${python:item.split('|||')[1]}" target="_blank">${python:item.split('|||')[0][0:23]}<span tal:condition="python:len(item.split('|||')[0])>23">...</span></a>
                  </li>
              </tal:li>
          </ul>
      </div>
  </metal:row>



<!-- 直播 slider(開新視窗到 youtube), 傳入: items, live_slider_id, col(owl-carousel-6 or owl-carousel-12) -->
  <metal:row define-macro="live_slider">
      <div class="live_slider">

<div class="${col} owl-theme owl-carousel">
  <div class="live_slider_item" tal:repeat="item items">
      <img tal:define="yUrl python:item.getObject().youtubeURL;
                       yId python:yUrl.split('/')[-1]"
           src="https://img.youtube.com/vi/${yId}/0.jpg" alt="${item/Title}" />
      <a href="${item/getURL}" title="${item/Description}" target="_blank">
          <div class="live-item-title">${python:item.Title[0:70]}${python:'...' if len(item.Title)>70 else None}</div>
      </a>
  </div>
</div>

      </div>
  </metal:row>


<!-- 分頁 tabs, BrowserView用, 傳入tabs_name, brains, tabs_id_prefix -->
  <metal:row define-macro="views_tabs">
    <div class="views_tabs">

      <ul class="nav nav-tabs">
          <li tal:repeat="tab tabs_name"
              class="${python:'active' if repeat['tab'].start else None}">
              <a data-toggle="tab" href="#${tabs_id_prefix}-${repeat/tab/index}">${tab}</a>
          </li>
      </ul>
      <div class="tab-content">
          <div tal:repeat="tab tabs_name"
               id="${tabs_id_prefix}-${repeat/tab/index}" class="tab-pane fade in ${python:'active' if repeat['tab'].start else None}">
              <ul>
                  <li tal:repeat="item python:brains[repeat['tab'].index]">
                      <a href="${item/getURL}">
                          ${python:item.Title[0:120]} ${python:'...' if len(item.Title) > 120 else None}
                      </a>
                  </li>
              </ul>
          </div>
      </div>

    </div>
  </metal:row>


<!-- 分頁 tabs for 最熱點擊, BrowserView用, 傳入tabs_name, brains, tabs_id_prefix -->
  <metal:row define-macro="hothit_tabs">
    <div class="views_tabs">

      <ul class="nav nav-tabs">
          <li tal:repeat="tab tabs_name"
              class="${python:'active' if repeat['tab'].start else None}">
              <a data-toggle="tab" href="#${tabs_id_prefix}-${repeat/tab/index}">${tab}</a>
          </li>
      </ul>
      <div class="tab-content">
          <div tal:repeat="tab tabs_name"
               id="${tabs_id_prefix}-${repeat/tab/index}" class="tab-pane fade in ${python:'active' if repeat['tab'].start else None}">

              <div class="row" tal:define="items python:brains[repeat['tab'].index][:6]">
                  <metal:macro use-macro="context/@@mingjing_macro/macros/listing_with_mini" />
              </div>
          </div>
      </div>

    </div>
  </metal:row>


<!-- 分頁 tabs, Portlet用 -->
  <metal:row define-macro="portlet_tabs">
    <div class="portlet_tabs">
      <ul class="nav nav-tabs">
          <li tal:repeat="tab view/data/tabs"
              class="${python:'active' if not repeat['tab'].index else None}">
              <a data-toggle="tab" href="#tab-${tab/to_object/id}">${tab/to_object/title}</a>
          </li>
      </ul>
      <div class="tab-content">
          <div tal:repeat="tab view/data/tabs"
               id="tab-${tab/to_object/id}" class="tab-pane fade in ${python:'active' if not repeat['tab'].index else None}">
              <ul>
                  <li tal:repeat="item python:list(tab.to_object.results())[0:10]">
                      <a href="${item/getURL}">
                          ${python:item.title[0:15]}
                      </a>
                  </li>
              </ul>
          </div>
      </div>
    </div>
  </metal:row>


<!-- 分類列表 -->
  <metal:row define-macro="categories_listing">
    <div class="categories_listing">
      <tal:folder repeat="i python:range(len(items))">
<div class="row" tal:condition="repeat/i/even">
        <div class="col-md-6">
          <div class="category-area" tal:define="newsList python:list(items[i].getObject().getChildNodes())">
            <h4 class="title-border category-title">
                <a href="${python:items[i].getURL()}" class="h4-title">${python:items[i].Title}</a>
            </h4>
            <ul class="category-block articles" tal:condition="python:len(newsList)>=5">
                <li tal:repeat="obj python:newsList[0:5]">
                    <h5><a href="${obj/absolute_url}">${python:obj.title[:23]}${python:'...' if len(obj.title)>23 else None}</a></h5>
                </li>
            </ul>
            <ul class="category-block articles" tal:condition="python:len(newsList)<5">
                <li tal:repeat="obj python:hot_news[0:5]">
                    <h5><a href="${obj/getURL}">${python:obj.Title[:65]}${python:'...' if len(obj.Title)>65 else None}</a></h5>
                </li>
            </ul>
          </div>
        </div>

        <div class="col-md-6" tal:condition="not:repeat/i/end">
          <div class="category-area" tal:define="newsList python:list(items[i+1].getObject().getChildNodes())">
            <h4 class="title-border category-title">
                <a href="${python:items[i+1].getURL()}" class="h4-title">${python:items[i+1].Title}</a>
            </h4>
            <ul class="category-block articles" tal:condition="python:len(newsList)>=5">
                <li tal:repeat="obj python:newsList[0:5]">
                    <h5><a href="${obj/absolute_url}">${python:obj.title[:23]}${python:'...' if len(obj.title)>23 else None}</a></h5>
                </li>
            </ul>
            <ul class="category-block articles" tal:condition="python:len(newsList)<5">
                <li tal:repeat="obj python:hot_news[0:5]">
                    <h5><a href="${obj/getURL}">${python:obj.Title[:65]}${python:'...' if len(obj.Title)>65 else None}</a></h5>
                </li>
            </ul>

          </div>
        </div>

        <tal:ad condition="python:not repeat['i'].index % 10 and not repeat['i'].start">
            <metal:macro use-macro="context/@@mingjing_macro/macros/ad_block">
        </tal:ad>
</div>
      </tal:folder>
    </div>
  </metal:row>


<!-- Item listing, 傳入 n 筆 brain -->
  <metal:row define-macro="item_listing">
      <div class="row item_listing">
            <div tal:repeat="item python:items"
                 class="category-blockarticles col-md-12">
                <div class="category-block articles">
                    <div class="post first">
                        <div class="row">
                            <a href="${item/getURL}">
                                <div class="image image-listing col-md-3">
                                            <img tal:condition="python:item.getObject().image"
                                                 src="${item/getURL}/@@images/image/mini" alt="${item/Title}"/>
                                            <img tal:condition="not:python:item.getObject().image" 
                                                 src="${portal/absolute_url}/resource/images/logo_gray.png/@@images/image/mini" alt="${item/Title}"/>

                                </div>
                            </a>
                            <div class="col-md-9 item-content">
                                <div class="meta">
                                    <span class="subject">
                                        <a href="${python:item.getObject().getParentNode().absolute_url()}">${python:item.getObject().getParentNode().title}</a>
                                    </span>
                                </div>
                                <h4><a href="${item/getURL}">${item/Title}</a></h4>
                                <p>${python:item.Description[0:240]}...<a href="${item/getURL}" class="read-more">更多</a></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
      </div>
  </metal:row>


<!-- Hot News, 傳入 4 筆 brain-->
  <metal:row define-macro="hot_news">

      <div class="row">
          <div class="col-md-6">
              <div class="category-block articles">
                  <div tal:define="item python:items[0]"
                       class="post first hover-dark">
                      <a href="${item/getURL}">
                           <div tal:condition="python:getattr(item.getObject(), 'image', False)"
                                class="image" data-src="${item/getURL}/@@images/image/preview">
                                <img class="hot-news-main-img" src="${item/getURL}/@@images/image/preview" alt="${item/Title}"/>
                           </div>
                           <div tal:condition="python:not getattr(item.getObject(), 'image', False)"
                                class="image" data-src="${item/getURL}/@@images/image/preview">
                                <img class="hot-news-main-img" src="${portal/absolute_url}/resource/images/logo_gray.png/@@images/image/preview" alt="${item/Title}"/>
                           </div>
                      </a>
                      <div class="meta">
                          <span class="subject">
                              <a href="${python:item.getObject().getParentNode().absolute_url()}">${python:item.getObject().getParentNode().title}</a>
                          </span>
                      </div>
                      <h4><a href="${item/getURL}">${item/Title}</a></h4>
                      <p>${python:item.Description[0:240]}...</p>
                  </div>
              </div>
          </div>
  
          <div class="col-md-6">
              <div class="category-block articles">

                  <!-- repeat 3 times -->
                  <div tal:repeat="item python:items[1:4]"
                       class="post hover-light">
                      <a href="${item/getURL}">
                                  <div tal:condition="python:item.getObject().image"
                                       class="image image-thumb" data-src="${item/getURL}/@@images/image/mini"></div>
                                  <div tal:condition="not:python:item.getObject().image"
                                       class="image image-thumb" data-src="${portal/absolute_url}/resource/images/logo_gray.png/@@images/image/mini"></div>
                      </a>
                      <h4><a href="${item/getURL}">${item/Title}</a></h4>
                      <p>${python:item.Description[:180]}...</p>
                      <div class="meta">
                          <span class="subject">
                              <a href="${python:item.getObject().getParentNode().absolute_url()}">${python:item.getObject().getParentNode().title}</a>
                          </span>
<!--                          <span class="date">2h</span> -->
                      </div>
                  </div>

              </div>
              <!-- end .category-block -->
          </div>
          <!-- end .col-6 -->
      </div>
      <!-- end .row -->

  </metal:row>


<!-- Ad Block 728*90 -->
  <metal:row define-macro="ad_block">
      <div style="max-width:728px; margin-left:auto; margin-right:auto">

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 728*90 display&text -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-6428195540030903"
     data-ad-slot="6560305675"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

      </div>
  </metal:row>

<!-- Ad Block 468*60 -->
  <metal:row define-macro="ad_block_468_60">
      <div style="max-width:468px; margin-left:auto; margin-right:auto">

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 文章下方橫幅廣告 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:468px;height:60px"
     data-ad-client="ca-pub-6428195540030903"
     data-ad-slot="8244569274"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

      </div>
  </metal:row>

<!-- Ad Block 250*250 -->
  <metal:row define-macro="ad_block_250_250">
      <div style="max-width:250px; margin-left:auto; margin-right:auto">
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- 方形 250*250 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:250px;height:250px"
     data-ad-client="ca-pub-6428195540030903"
     data-ad-slot="9082600078"></ins>
<script>
      </div>
  </metal:row>



<!-- listing_with_mini, 傳入 items(brain) -->
  <metal:row define-macro="listing_with_mini">

<?python
from DateTime import DateTime
?>
      <div class="col-md-6">
          <div class="category-block articles listing_with_mini">
              <tal:item repeat="item items">
                                <div class="post hover-light" tal:condition="repeat/item/even">
                                    <a href="${item/getURL}">
                                                <div tal:condition="python:item.getObject().image"
                                                     class="image image-thumb"
                                                     data-src="${item/getURL}/@@images/image/mini"
                                                     style="background-image: url('');"></div>
                                                <div tal:condition="python:not item.getObject().image"
                                                     class="image image-thumb"
                                                     data-src="${portal/absolute_url}/resource/images/logo_gray.png/@@images/image/mini"
                                                     style="background-image: url('');"></div>
                                    </a>
                                    <h4><a href="${item/getURL}">${python:item.Title[0:45]}${python:'...' if len(item.Title) > 45 else None}</a></h4>
                                    <p>${python:item.Description[0:135]}...<a href="${item/getURL}" class="read-more">更多</a></p>
                                    <div class="meta">
                                        <span class="pull-right theme-cover-span date">${python:int(DateTime()-item.created)} 小時前</span>
                                    </div>
                                </div>
              </tal:item>
          </div>
      </div>
      <!-- end .category-block -->

      <div class="col-md-6">
          <div class="category-block articles listing_with_mini">
              <tal:item repeat="item items">
                                <div class="post hover-light" tal:condition="repeat/item/odd">
                                    <a href="${item/getURL}">
                                                <div tal:condition="python:item.getObject().image"
                                                     class="image image-thumb"
                                                     data-src="${item/getURL}/@@images/image/mini"
                                                     style="background-image: url('');"></div>
                                                <div tal:condition="python:not item.getObject().image"
                                                     class="image image-thumb"
                                                     data-src="${portal/absolute_url}/resource/images/logo_gray.png/@@images/image/mini"
                                                     style="background-image: url('');"></div>
                                    </a>
                                    <h4><a href="${item/getURL}">${python:item.Title[0:45]}${python:'...' if len(item.Title) > 45 else None}</a></h4>
                                    <p>${python:item.Description[0:135]}...<a href="${item/getURL}" class="read-more">更多</a></p>
                                    <div class="meta">
                                        <span class="pull-right theme-cover-span date">${python:int(DateTime()-item.created)} 小時前</span>
                                    </div>
                                </div>
              </tal:item>
          </div>
      <!-- end .category-block -->
      </div>
  </metal:row>


<!-- 明鏡火拍, 傳入 items(brain) -->
<!--  <metal:row define-macro="mingjing_youtube">
      <h3 class="category-title"><span>明鏡火拍</span></h3>
          <div class="row">
              <tal:repeat repeat="item items">
                                  <div class="col-md-6">
                                    <div class="category-block articles">
                                        <div class="post first hover-dark">
                                            <a href="${item/getURL}/@@to_youtube" target="_blank">
                                                <div class="image" data-src="${item/getURL}/@@images/image/preview">
                                                </div>
                                            </a>
                                            <h4>
                                                <a href="${item/getURL}/@@to_youtube" target="_blank">${item/Title}</a>
                                            </h4>
                                        </div>
                                    </div>
                                  </div>
              </tal:repeat>
          </div>
  </metal:row>
-->

<!-- Listing with preview image, 傳入 items(brain) -->
  <metal:row define-macro="listing_with_preview">
      <tal:repeat repeat="item items">
                                  <div class="col-md-6">
                                    <div class="category-block articles">

                                        <div class="post first hover-dark">
                                            <a tal:attributes="href item/getURL">
                                                <div class="image" tal:attributes="data-src string:${item/getURL}/@@images/image/preview">
                                                </div>
                                            </a>
                                            <h4><a tal:attributes="href item/getURL" tal:content="item/Title"></a></h4>
                                            <p tal:content="item/description"></p>
                                        </div>
                                    </div>
                                  </div>
      </tal:repeat>
  </metal:row>


<!-- Main Slider, 傳入 items(brain) / main_slider_id-->
  <metal:row define-macro="main_slider">

      <div class="slider-b">
                <div class="news-slider news-block mv5 mvt0">
                    <!-- masterslider -->
                    <div class="master-slider ms-skin-default" id="${main_slider_id}">
       
                        <div class="ms-slide" data-delay="6" tal:repeat="item items">

                                <img tal:condition="python:item.getObject().image"
                                     src="/++resource++mingjing.theme/images/blank.gif"
                                     data-src="${string:${item/getURL}/@@images/image/preview}"
                                     alt="${item/Title}" />

                                <img tal:condition="python:not item.getObject().image"
                                     src="/++resource++mingjing.theme/images/blank.gif"
                                     data-src="${portal/absolute_url}/resource/images/logo_gray.png/@@images/image/preview"
                                     alt="${item/Title}" />

                            <div class="ms-thumb post hover-zoom">
                                <div class="thumb-meta">
                                    <h4>${python:item.Title[0:42]}</h4>
                                </div>
                            </div>
                            
                            <div class="ms-layer box" data-delay="0" data-effect="fade" data-duration="0" data-ease="easeInOut">

                                <h4 class="animate-element" data-anim="fadeInUp">
                                    <a tal:attributes="href item/getURL">${item/Title}</a></h4>
                                <p class="animate-element" data-anim="fadeInUp">${python:item.Description[0:180]}...</p>

                            </div>

                        </div>

                    </div>
                    <!-- end of masterslider -->

                </div>
      </div>
  </metal:row>

</body>
</html>

